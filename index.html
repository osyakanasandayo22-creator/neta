<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <title>Neta.</title>
  <link rel="stylesheet" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- 追加 -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#800000">
</head>
<body>
  <img src="./images/neta.png" alt="ネタ">
  <textarea id="jokeInput" placeholder="書く"></textarea>
  <button id="pastButton">過去のネタを見る</button>

  <script>
    const input = document.getElementById('jokeInput');
    const pastButton = document.getElementById('pastButton');
    
    // --- 高さ自動調整用 ---
    function adjustHeight(el) {
      el.style.height = 'auto';
      el.style.height = el.scrollHeight + 'px';
    }
    
    // 初期高さ調整
    adjustHeight(input);
    
    // 入力ごとに高さ調整
    input.addEventListener('input', () => {
      adjustHeight(input);
    });
    
    // --- Enterでネタを保存 ---
    input.addEventListener('keypress', e => {
  if (e.key === 'Enter' && input.value.trim() !== '') {
    e.preventDefault(); // ← これを追加。Enterの改行を防ぐ

    let jokes = JSON.parse(localStorage.getItem('jokes') || '[]');

// index.html
const newJoke = {
  id: Date.now(),      // ユニークID
  text: input.value.trim(),
  date: new Date().toLocaleString(),
  likes: 0
};

    jokes.push(newJoke);
    localStorage.setItem('jokes', JSON.stringify(jokes));
    input.value = '';

    adjustHeight(input); // 高さリセット
    const toast = document.getElementById('toast');
toast.classList.add('show');

setTimeout(() => {
  toast.classList.remove('show');
}, 2000);
  }
});
    
    // --- 過去ページへ ---
    pastButton.addEventListener('click', () => {
      window.location.href = 'past.html';
    });
    // 追加
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/service-worker.js')
      .then((registration) => {
        console.log('SW registered:', registration);
      })
      .catch((error) => {
        console.log('SW registration failed:', error);
      });
  });
}
    </script>
  <div id="toast">投稿が完了しました。</div>
</body>
</html>