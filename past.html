<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Neta.</title>
  <link rel="stylesheet" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    #searchInput {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 2px solid #222;
      margin-bottom: 15px;
      box-sizing: border-box;
    }

    #sortSelect {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 2px solid #222;
      margin-bottom: 15px;
      box-sizing: border-box;
      background: #fff;
      cursor: pointer;
    }

    li {
      padding: 10px;
      border-bottom: 1px solid #ccc;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
    }

    li span {
      flex: 1 1 auto;
      word-break: break-word;
    }

    li button {
      padding: 6px 12px;
      font-size: 14px;
      border: 1px solid #222;
      background: #fff;
      color: #222;
      margin-left: 5px;
      margin-top: 5px;
      cursor: pointer;
      transition: background 0.2s, border-color 0.2s, color 0.2s;
    }

    li button:hover {
      background: #007acc;
      color: #fff;
    }

    #addButton {
      margin-top: 20px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: 500;
      border: 2px solid #222;
      background: #222;
      color: #fff;
      cursor: pointer;
      transition: background 0.2s, border-color 0.2s, color 0.2s;
    }

    #addButton:hover {
      background: #007acc;
      border-color: #007acc;
    }
  </style>
</head>
<body>
  <img src="neta.png" alt="„Éç„Çø">

  <!-- Ê§úÁ¥¢„Éï„Ç©„Éº„É† -->
  <input type="text" id="searchInput" placeholder="Ê§úÁ¥¢„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ">

  <!-- „ÇΩ„Éº„Éà„Çª„É¨„ÇØ„Éà -->
  <select id="sortSelect">
    <option value="latest">ÊúÄÊñ∞È†Ü</option>
    <option value="popular">‰∫∫Ê∞óÈ†Ü</option>
  </select>

  <ul id="jokeList"></ul>
  <button id="addButton" onclick="window.location.href='index.html'">„Éç„Çø„ÇíËøΩÂä†„Åô„Çã</button>

  <script>
    const jokeList = document.getElementById('jokeList');
    const searchInput = document.getElementById('searchInput');
    const sortSelect = document.getElementById('sortSelect');

    function loadJokes(filter = '', sort = 'latest') {
      jokeList.innerHTML = '';
      let jokes = JSON.parse(localStorage.getItem('jokes') || '[]');

      // Ê§úÁ¥¢„Éï„Ç£„É´„Çø„Éº
      if (filter) {
        jokes = jokes.filter(j => j.text.includes(filter));
      }

      // „ÇΩ„Éº„Éà
      if (sort === 'latest') {
        jokes.sort((a, b) => new Date(b.date) - new Date(a.date));
      } else if (sort === 'popular') {
        jokes.sort((a, b) => (b.likes || 0) - (a.likes || 0));
      }

      jokes.forEach((j, index) => {
  const li = document.createElement('li');

  // „Éç„Çø„Å®Êó•‰ªò
  const textSpan = document.createElement('span');
  textSpan.textContent = `${j.text} Ôºà${j.date}Ôºâ`;
  li.appendChild(textSpan);

  // „ÅÑ„ÅÑ„Å≠„Éú„Çø„É≥
  const likeBtn = document.createElement('button');
  likeBtn.textContent = `ü§∑‚Äç‚ôÇÔ∏è ${j.likes || 0}`;

  likeBtn.addEventListener('click', () => {
    const allJokes = JSON.parse(localStorage.getItem('jokes') || '[]');
    const target = allJokes.find(item => item.id === j.id);
    if (target) {
      target.likes = (target.likes || 0) + 1;
      localStorage.setItem('jokes', JSON.stringify(allJokes));
      loadJokes(searchInput.value, sortSelect.value);
    }
  });

  // ÂâäÈô§„Éú„Çø„É≥
  const delBtn = document.createElement('button');
  delBtn.textContent = 'ÂâäÈô§';

  delBtn.addEventListener('click', () => {
    let allJokes = JSON.parse(localStorage.getItem('jokes') || '[]');
    allJokes = allJokes.filter(item => item.id !== j.id);
    localStorage.setItem('jokes', JSON.stringify(allJokes));
    loadJokes(searchInput.value, sortSelect.value);
  });

  // ‚òÖ „Éú„Çø„É≥„Çí„Åæ„Å®„ÇÅ„Çã„É©„ÉÉ„Éë„Éº
  const btnWrap = document.createElement('div');
  btnWrap.className = 'btnWrap';

  btnWrap.appendChild(likeBtn);
  btnWrap.appendChild(delBtn);

  li.appendChild(btnWrap);

  jokeList.appendChild(li);
});
}
    // ÂàùÊúüË°®Á§∫
    loadJokes();

    // Ê§úÁ¥¢ÂÖ•Âäõ„Åî„Å®„Å´Êõ¥Êñ∞
    searchInput.addEventListener('input', () => {
      loadJokes(searchInput.value, sortSelect.value);
    });

    // „ÇΩ„Éº„ÉàÂ§âÊõ¥
    sortSelect.addEventListener('change', () => {
      loadJokes(searchInput.value, sortSelect.value);
    });
  </script>
</body>
</html>